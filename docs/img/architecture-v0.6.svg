<svg width="960" height="320" viewBox="0 0 960 320" xmlns="http://www.w3.org/2000/svg">
  <style>
    .box { fill: #2563eb; stroke: #1e3a8a; stroke-width: 2; rx: 12; }
    .service { fill: #059669; stroke: #064e3b; stroke-width: 2; rx: 12; }
    .text { font: 16px 'Segoe UI', 'Helvetica Neue', Arial, sans-serif; fill: #0f172a; }
    .arrow { stroke: #475569; stroke-width: 2; marker-end: url(#arrowhead); }
    .note { font: 13px 'Segoe UI', 'Helvetica Neue', Arial, sans-serif; fill: #475569; }
  </style>
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#475569" />
    </marker>
  </defs>
  <rect class="box" x="40" y="110" width="180" height="100" fill="#f8fafc" />
  <text class="text" x="130" y="165" text-anchor="middle">Browser Client</text>
  <text class="note" x="130" y="190" text-anchor="middle">/login â†’ session cookie</text>

  <rect class="box" x="280" y="40" width="200" height="90" fill="#bfdbfe" />
  <text class="text" x="380" y="95" text-anchor="middle">`/login`</text>
  <text class="note" x="380" y="70" text-anchor="middle">OAuth redirect</text>

  <rect class="box" x="280" y="190" width="200" height="90" fill="#bfdbfe" />
  <text class="text" x="380" y="245" text-anchor="middle">`/session`</text>
  <text class="note" x="380" y="220" text-anchor="middle">Returns EffectiveAuth</text>

  <rect class="service" x="540" y="40" width="220" height="90" fill="#d1fae5" />
  <text class="text" x="650" y="95" text-anchor="middle">`/authz`</text>
  <text class="note" x="650" y="70" text-anchor="middle">Caches directory data</text>

  <rect class="service" x="540" y="190" width="220" height="90" fill="#d1fae5" />
  <text class="text" x="650" y="245" text-anchor="middle">`/authz/check`</text>
  <text class="note" x="650" y="220" text-anchor="middle">Evaluates module:action</text>

  <rect class="box" x="800" y="110" width="140" height="100" fill="#f8fafc" />
  <text class="text" x="870" y="160" text-anchor="middle">API / UI</text>
  <text class="note" x="870" y="185" text-anchor="middle">Requires permissions</text>

  <line class="arrow" x1="220" y1="160" x2="280" y2="90" />
  <line class="arrow" x1="220" y1="160" x2="280" y2="240" />
  <line class="arrow" x1="480" y1="90" x2="540" y2="90" />
  <line class="arrow" x1="480" y1="240" x2="540" y2="240" />
  <line class="arrow" x1="760" y1="90" x2="800" y2="160" />
  <line class="arrow" x1="760" y1="240" x2="800" y2="160" />
  <line class="arrow" x1="870" y1="210" x2="870" y2="160" marker-end="" />

  <text class="note" x="150" y="290">1. User hits `/login`, completes OAuth.</text>
  <text class="note" x="150" y="310">2. Front end fetches `/session` for EffectiveAuth.</text>
  <text class="note" x="540" y="290">3. Backend caches auth via `/authz`.</text>
  <text class="note" x="540" y="310">4. APIs evaluate permissions via `/authz/check`.</text>
</svg>
